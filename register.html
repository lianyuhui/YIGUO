<!--本--------------却
    是              因
    青              浊
    灯              酒
    不              留
    归              凤
    客              尘
    ，--------------！ -->

<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>易果|注册</title>
<link rel="stylesheet" type="text/css" href="css/register.css"/>
</head>
<body>
  <div class="yg">
    <div class="header">
      <div class="warp">
        <div class="logo">
           <a href="index.html"><img src="img/register/logo.jpg"></a>
           <p>注册</p>
        </div>
      </div>
    </div>
    <div class="register">
      <div class="warp">
        <div class="gologin">
          我已经注册，现在就
          <a href="login.html">登录</a>
        </div>
        <div class="act-left">
          <p>
              <i id="usernameMessage1"></i>
              
          </p>
          <p>
            <span>手机号</span>
            <input type="text" name="" id="username">
            <i id="usernameMessage11"></i>
          </p>
          <p>
            <span>手机验证码</span>
            <input type="text" name="">
            <a href="">获取验证码</a>
          </p>
          <p>
            <span>设置密码</span>
            <input type="password" name="" id="userpass">
            <i id="usernameMessage2"></i>
          </p>
          <p>
            <span>确认密码</span>
            <input type="password" name="" id="chong">
            <i id="usernameMessage3"></i>
          </p>
          <p>
            <span>会员名</span>
            <input type="text" id="vipname" name="">
          </p>
          <p>
            <input type="checkbox" checked="check">我已阅读并同意
            <a href="">《易果服务协议》</a>
          </p>
          <p>
            <button type="submit" id="btn" alt="注册" style=" display: inline-block;
              width: 316px;
              height: 50px;
              line-height: 50px;
              margin-left: 240px;
              text-align: center;
              color: #fff;
              background-color: #008842;
              font-size: 18px;
              cursor: pointer">注册</button>

          </p>
        </div>
        <div class="act-right">
          <img src="img/register/rec.png" alt="">
        </div>
      </div>
    </div>
    <div class="footer">
      <div class="warp">
        <div class="ll ll1">
          <p>新手指南</p>
          <ul>
            <li><a href="registersteps.html">账户注册</a></li>
            <li><a href="">购物流程</a></li>
            <li><a href="">订购方式</a></li>
            <li><a href="">悠币说明</a></li>
            <li><a href="">会员等级</a></li>
          </ul>
        </div>
        <div class="ll ll2">
          <p>付款方式</p>
          <ul>
            <li><a href="">支付方式/发票说明</a></li>
            <li><a href="">重置说明/储值卡说明</a></li>
            <li><a href="">优惠代码/礼品卡说明</a></li>
            <li><a href="">卡券购买章程</a></li>
          </ul>
        </div>
        <div class="ll ll3">
          <p>配送方式</p>
          <ul>
            <li><a href="">配送运费</a></li>
            <li><a href="">配送范围</a></li>
            <li><a href="">配送时间</a></li>
          </ul>
        </div>
        <div class="ll ll4">
          <p>售后服务</p>
          <ul>
            <li><a href="">退换货政策</a></li>
            <li><a href="">退换货流程</a></li>
            <li><a href="">常见问题</a></li>
            <li><a href="">急速退款</a></li>
            <li><a href="">投诉与建议</a></li>
          </ul>
        </div>
        <div class="ll ll5">
          <p>关于我们</p>
          <ul>
            <li><a href="">公司介绍</a></li>
            <li><a href="">联系我们</a></li>
            <li><a href="">业务合作</a></li>
            <li><a href="">诚信举报</a></li>
            <li><a href="">人才招聘</a></li>
            <li><a href="">友情链接</a></li>
          </ul>
        </div>
        <div class="rexian">
          <p>客服热线 400-000-7788 企业采购或团购，请转2号键咨询<span>周一至周日 9:00-21:00</span></p>
        </div>
        <div class="copy">
          <p class="p1">所有图片均受著作权保护，未经许可任何单位与个人不得使用、复制、转载、摘编，违者必究法律责任。</p>
          <p class="p2">
            <a href="">沪ICP备09008015号 </a>  Copyright © 2005-2018 
            <a href="">上海易果电子商务有限公司</a>版权所有
          </p>
          <p class="p3">
            <a href=""><img src="img/register/copy1.png"></a>
            <a href=""><img src="img/register/copy2.png" width="38" height="47"></a>
            <a href=""><img src="img/register/copy3.gif"></a>
            <a href=""><img src="img/register/copy4.png"><span>沪公网安备 31010502000002号</span></a>
          </p>
        </div>
      </div>
    </div>
  </div>
  
</body>
</html>

<script type="text/javascript"></script>
<script type="text/javascript">

function $(str){
    if(str.charAt(0)=="#"){
        return document.getElementById(str.substring(1));
    }else if(str.charAt(0)=="."){
        return document.getElementsByClassName(str.substring(1));
    }else{
        return document.getElementsByTagName(str);
    }
}



window.onload = function(){


     // 正则用户名（手机号）
     $("#username").onkeyup = function(){
    let reg = /^1[3-9]\d{9}$/; 
    
    let str1= this.value;
    if(reg.test(str1)){
            $("#usernameMessage11").innerHTML = "√";
           
    }else{
      $("#usernameMessage11").innerHTML = "请输入正确的手机号！";
        } 
          
    }
    //密码
    $("#userpass").onkeyup = function(){
        //（必须包含字母、数字、特殊字符，长度6个字符以上）
        let regLetter = /[a-zA-Z]/; 
        let regNum = /[0-9]/; 
        let regSpecial = /[\@^*$!#]/; 

        var str2 = this.value;
        if(str2.length>=6 && regLetter.test(str2) && regNum.test(str2) && regSpecial.test(str2) ){
            $("#usernameMessage2").innerHTML = "√";
        }else{
            $("#usernameMessage2").innerHTML = "6位以上字母、数字、特殊字符";
        }  
    }

     $("#chong").onkeyup = function(){
        if($("#userpass").value != $("#chong").value){
            $("#usernameMessage3").innerHTML = "密码不一致";
        }else{
            $("#usernameMessage3").innerHTML = "√";
        }
     }
//连接
    $("#btn").onclick = function(){
        //1、创建对象
        let xhr = new XMLHttpRequest();
        
        //2、设置请求参数
        xhr.open("post","regSave.php",true);
        
        //3、设置回调函数
        xhr.onreadystatechange = function(){
            if(xhr.readyState==4 && xhr.status==200){
                //5、接收响应
                let str = xhr.responseText;
                console.log(str);
                if(str=="0"){
                  $("#usernameMessage1").innerHTML="注册失败，服务器出错！";
                    
                }else{
                    alert("恭喜您，注册成功！");
                    location.href="login.html";
                }
            }
        }
        
        xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
        
        //4、发送请求
        let str = "username="+$("#username").value+"&userpass="+$("#userpass").value;
        xhr.send(str);
    }

    $("#username").onblur = function(){
        //1、创建对象
        let xhr = new XMLHttpRequest();
        
        //2、设置请求参数
        xhr.open("get","register.php?username="+this.value,true);       
        //3、设置回调函数
        xhr.onreadystatechange = function(){
            if(xhr.readyState==4 && xhr.status==200){
                //5、接收响应
                let str = xhr.responseText;
                // console.log(str);
                if(str=="1"){
                    $("#usernameMessage1").innerHTML = "用户名已被注册";
                // }else if(str=="1" || $("#username").value == ""){
                //     $("#usernameMessage1").innerHTML = "";
                }else{
                    $("#usernameMessage1").innerHTML = "用户名未被注册";
                }
            }
        }
        //4、发送请求
        xhr.send();
    }    
}

</script> 